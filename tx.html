<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C√¥ng C·ª• Ph√¢n T√≠ch T√†i X·ªâu SunWin Pro</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }
        h1 {
            color: #e74c3c;
            text-align: center;
            margin-bottom: 30px;
        }
        .container {
            background-color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .input-section {
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2c3e50;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            box-sizing: border-box;
            font-size: 16px;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 18px;
            width: 100%;
            font-weight: bold;
            transition: background-color 0.3s;
            margin-top: 10px;
        }
        button:hover {
            background-color: #c0392b;
        }
        .result {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            display: none;
            border-left: 4px solid #e74c3c;
        }
        .history-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .history-item {
            padding: 10px;
            text-align: center;
            border-radius: 5px;
            font-weight: bold;
        }
        .tai {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
            border: 1px solid #27ae60;
        }
        .xiu {
            background-color: rgba(231, 76, 60, 0.2);
            color: #c0392b;
            border: 1px solid #c0392b;
        }
        .analysis-section {
            margin-top: 25px;
            padding: 15px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        .prediction {
            font-size: 20px;
            padding: 15px;
            text-align: center;
            margin: 20px 0;
            border-radius: 8px;
            background-color: #f8f9fa;
            border: 1px dashed #3498db;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        .stat-box {
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            min-width: 120px;
            margin: 5px;
        }
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            margin: 5px 0;
        }
        .trend-indicator {
            font-size: 14px;
            color: #7f8c8d;
        }
        .hot {
            color: #e74c3c;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .pattern {
            margin-top: 15px;
            padding: 10px;
            background-color: #eaf2f8;
            border-radius: 5px;
        }
        .error {
            color: #e74c3c;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÆ C√¥ng C·ª• Ph√¢n T√≠ch T√†i X·ªâu SunWin Pro</h1>
        
        <div class="input-section">
            <label for="round-ids">Nh·∫≠p m√£ phi√™n (ID c√°c phi√™n, c√°ch nhau b·∫±ng d·∫•u ph·∫©y ho·∫∑c xu·ªëng d√≤ng):</label>
            <textarea id="round-ids" placeholder="V√≠ d·ª•: 
123456
123457
123458
123459"></textarea>
        </div>
        
        <div class="input-section">
            <label for="results">Nh·∫≠p k·∫øt qu·∫£ t∆∞∆°ng ·ª©ng (T√†i/X·ªâu, c√πng th·ª© t·ª± v·ªõi m√£ phi√™n):</label>
            <textarea id="results" placeholder="V√≠ d·ª•: 
T√†i
X·ªâu
T√†i
T√†i"></textarea>
            <div id="input-error" class="error"></div>
        </div>
        
        <div class="input-section">
            <label for="analysis-type">Ch·∫ø ƒë·ªô ph√¢n t√≠ch:</label>
            <select id="analysis-type">
                <option value="advanced">Ph√¢n t√≠ch n√¢ng cao</option>
                <option value="pattern">Nh·∫≠n di·ªán m·∫´u chu·ªói</option>
                <option value="trend">Ph√¢n t√≠ch xu h∆∞·ªõng</option>
                <option value="probability">Th·ªëng k√™ x√°c su·∫•t</option>
            </select>
        </div>
        
        <button id="analyze-btn">PH√ÇN T√çCH & D·ª∞ ƒêO√ÅN</button>
        
        <div id="result" class="result">
            <!-- K·∫øt qu·∫£ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã ·ªü ƒë√¢y -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Th√™m s·ª± ki·ªán click cho n√∫t ph√¢n t√≠ch
            document.getElementById('analyze-btn').addEventListener('click', analyzeData);
        });

        function analyzeData() {
            // Reset th√¥ng b√°o l·ªói
            document.getElementById('input-error').textContent = '';
            
            // L·∫•y d·ªØ li·ªáu ƒë·∫ßu v√†o
            const roundIdsInput = document.getElementById('round-ids').value;
            const resultsInput = document.getElementById('results').value;
            const analysisType = document.getElementById('analysis-type').value;
            
            // Ki·ªÉm tra d·ªØ li·ªáu ƒë·∫ßu v√†o
            if (!resultsInput.trim()) {
                document.getElementById('input-error').textContent = 'Vui l√≤ng nh·∫≠p k·∫øt qu·∫£ T√†i/X·ªâu';
                return;
            }
            
            // X·ª≠ l√Ω d·ªØ li·ªáu
            const roundIds = roundIdsInput.split(/[\n,]+/).map(id => id.trim()).filter(id => id !== '');
            const results = resultsInput.split(/[\n,]+/).map(res => res.trim().toLowerCase()).filter(res => res !== '');
            
            // Ki·ªÉm tra k·∫øt qu·∫£ h·ª£p l·ªá
            const invalidResults = results.filter(res => res !== 't√†i' && res !== 'x·ªâu');
            if (invalidResults.length > 0) {
                document.getElementById('input-error').textContent = `C√≥ k·∫øt qu·∫£ kh√¥ng h·ª£p l·ªá: ${invalidResults.join(', ')}. Ch·ªâ ch·∫•p nh·∫≠n "T√†i" ho·∫∑c "X·ªâu".`;
                return;
            }
            
            // T·∫°o n·ªôi dung k·∫øt qu·∫£
            let resultHTML = `
                <h2>üìä K·∫øt Qu·∫£ Ph√¢n T√≠ch Chuy√™n S√¢u</h2>
                
                <div class="stats">
                    <div class="stat-box">
                        <div>T·ªïng phi√™n</div>
                        <div class="stat-value" id="total-rounds">${results.length}</div>
                    </div>
            `;
            
            // Th·ªëng k√™ c∆° b·∫£n
            const taiCount = results.filter(r => r === 't√†i').length;
            const xiuCount = results.filter(r => r === 'x·ªâu').length;
            const taiPercent = results.length > 0 ? Math.round(taiCount / results.length * 100) : 0;
            const xiuPercent = results.length > 0 ? Math.round(xiuCount / results.length * 100) : 0;
            
            resultHTML += `
                    <div class="stat-box">
                        <div>T√†i</div>
                        <div class="stat-value">${taiCount}</div>
                        <div>${taiPercent}%</div>
                    </div>
                    <div class="stat-box">
                        <div>X·ªâu</div>
                        <div class="stat-value">${xiuCount}</div>
                        <div>${xiuPercent}%</div>
                    </div>
            `;
            
            // Ph√¢n t√≠ch xu h∆∞·ªõng
            let trend = "·ªîn ƒë·ªãnh";
            let trendIndicator = "";
            if (results.length >= 3) {
                const last3 = results.slice(-3);
                const taiLast3 = last3.filter(r => r === 't√†i').length;
                const xiuLast3 = last3.filter(r => r === 'x·ªâu').length;
                
                if (taiLast3 === 3) {
                    trend = "T√†i m·∫°nh";
                    trendIndicator = "üî• T√†i ƒëang n√≥ng";
                } else if (xiuLast3 === 3) {
                    trend = "X·ªâu m·∫°nh";
                    trendIndicator = "‚ùÑÔ∏è X·ªâu ƒëang l·∫°nh";
                } else if (taiLast3 >= 2) {
                    trend = "T√†i nh·∫π";
                    trendIndicator = "‚ÜóÔ∏è T√†i ƒëang l√™n";
                } else if (xiuLast3 >= 2) {
                    trend = "X·ªâu nh·∫π";
                    trendIndicator = "‚ÜòÔ∏è X·ªâu ƒëang xu·ªëng";
                }
            }
            
            resultHTML += `
                    <div class="stat-box">
                        <div>Xu h∆∞·ªõng</div>
                        <div class="stat-value">${trend}</div>
                        <div class="trend-indicator ${trendIndicator.includes("n√≥ng") || trendIndicator.includes("l·∫°nh") ? 'hot' : ''}">${trendIndicator}</div>
                    </div>
                </div>
            `;
            
            // Hi·ªÉn th·ªã l·ªãch s·ª≠
            resultHTML += `
                <div class="analysis-section">
                    <h3>üìã L·ªãch S·ª≠ Phi√™n</h3>
                    <div class="history-grid" id="history-display">
            `;
            
            results.forEach((result, index) => {
                const roundId = index < roundIds.length ? roundIds[index] : (index + 1);
                resultHTML += `
                    <div class="history-item ${result === 't√†i' ? 'tai' : 'xiu'}" title="Phi√™n ${roundId}: ${result === 't√†i' ? 'T√†i' : 'X·ªâu'}">
                        ${result === 't√†i' ? 'T' : 'X'}
                    </div>
                `;
            });
            
            resultHTML += `
                    </div>
                </div>
            `;
            
            // Ph√¢n t√≠ch m·∫´u chu·ªói
            let sequences = [];
            let currentSequence = [];
            
            for (let i = 0; i < results.length; i++) {
                const result = results[i];
                
                if (currentSequence.length === 0 || currentSequence[currentSequence.length - 1] === result) {
                    currentSequence.push(result);
                } else {
                    if (currentSequence.length >= 2) {
                        sequences.push({
                            type: currentSequence[0],
                            length: currentSequence.length
                        });
                    }
                    currentSequence = [result];
                }
            }
            
            // Th√™m chu·ªói cu·ªëi c√πng
            if (currentSequence.length >= 2) {
                sequences.push({
                    type: currentSequence[0],
                    length: currentSequence.length
                });
            }
            
            resultHTML += `
                <div class="analysis-section">
                    <h3>üß© M·∫´u Chu·ªói Ph·ªï Bi·∫øn</h3>
            `;
            
            if (sequences.length > 0) {
                const longestSequence = sequences.reduce((max, seq) => seq.length > max.length ? seq : max, sequences[0]);
                resultHTML += `<p>Chu·ªói d√†i nh·∫•t: ${longestSequence.length} l·∫ßn ${longestSequence.type === 't√†i' ? 'T√†i' : 'X·ªâu'} li√™n ti·∫øp</p>`;
                
                const taiSequences = sequences.filter(seq => seq.type === 't√†i');
                const xiuSequences = sequences.filter(seq => seq.type === 'x·ªâu');
                
                if (taiSequences.length > 0) {
                    const avgTaiSeq = Math.round(taiSequences.reduce((sum, seq) => sum + seq.length, 0) / taiSequences.length * 10) / 10;
                    resultHTML += `<p>Trung b√¨nh chu·ªói T√†i: ${avgTaiSeq} phi√™n</p>`;
                }
                
                if (xiuSequences.length > 0) {
                    const avgXiuSeq = Math.round(xiuSequences.reduce((sum, seq) => sum + seq.length, 0) / xiuSequences.length * 10) / 10;
                    resultHTML += `<p>Trung b√¨nh chu·ªói X·ªâu: ${avgXiuSeq} phi√™n</p>`;
                }
            } else {
                resultHTML += `<p>Kh√¥ng t√¨m th·∫•y chu·ªói d√†i n√†o</p>`;
            }
            
            resultHTML += `</div>`;
            
            // D·ª± ƒëo√°n
            resultHTML += `
                <div class="prediction">
                    <h3>üîÆ D·ª± ƒêo√°n Phi√™n Ti·∫øp Theo</h3>
                    <div id="next-prediction" style="font-size: 24px; font-weight: bold;">
            `;
            
            if (results.length < 3) {
                resultHTML += "C·∫ßn √≠t nh·∫•t 3 phi√™n ƒë·ªÉ d·ª± ƒëo√°n";
            } else {
                let predictionScore = 0;
                const lastResult = results[results.length - 1];
                const secondLastResult = results[results.length - 2];
                
                // 1. Xu h∆∞·ªõng chung
                if (taiCount > xiuCount) predictionScore += 1;
                else if (xiuCount > taiCount) predictionScore -= 1;
                
                // 2. Xu h∆∞·ªõng g·∫ßn ƒë√¢y
                const last3Tai = results.slice(-3).filter(r => r === 't√†i').length;
                const last3Xiu = results.slice(-3).filter(r => r === 'x·ªâu').length;
                
                if (last3Tai >= 2) predictionScore += 1.5;
                if (last3Xiu >= 2) predictionScore -= 1.5;
                
                // 3. M·∫´u l·∫∑p l·∫°i
                if (lastResult === secondLastResult) {
                    predictionScore += lastResult === 't√†i' ? -1 : 1;
                }
                
                // ƒê∆∞a ra d·ª± ƒëo√°n
                if (predictionScore > 0) {
                    resultHTML += "T√ÄI";
                    const confidence = Math.min(90, Math.max(60, Math.round(taiPercent + (predictionScore * 5)));
                    resultHTML += `</div><div>ƒê·ªô tin c·∫≠y: ${confidence}%</div>`;
                    document.getElementById('next-prediction').style.color = "#27ae60";
                } else if (predictionScore < 0) {
                    resultHTML += "X·ªàU";
                    const confidence = Math.min(90, Math.max(60, Math.round(xiuPercent + (Math.abs(predictionScore) * 5))));
                    resultHTML += `</div><div>ƒê·ªô tin c·∫≠y: ${confidence}%</div>`;
                    document.getElementById('next-prediction').style.color = "#e74c3c";
                } else {
                    resultHTML += "KH√îNG R√ï";
                    resultHTML += `</div><div>Kh√¥ng c√≥ ƒë·ªß d·ªØ li·ªáu ƒë·ªÉ d·ª± ƒëo√°n ch√≠nh x√°c</div>`;
                    document.getElementById('next-prediction').style.color = "#7f8c8d";
                }
            }
            
            resultHTML += `</div>`;
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            document.getElementById('result').innerHTML = resultHTML;
            document.getElementById('result').style.display = 'block';
        }
    </script>
</body>
</html>
